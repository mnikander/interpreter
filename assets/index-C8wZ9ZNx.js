(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))u(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function u(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();function _(e){let n=0,t=!0;for(let r=0;r<e.length;r++)e[r]=="("?n++:e[r]==")"&&n--,n<0&&(t=!1);let u=n==0;return t&&u}function R(e){let n="";for(let t=0;t<e.length;t++)e[t]=="("?n+=" ( ":e[t]==")"?n+=" ) ":n+=e[t];return n}function p(e){return e.kind=="TK_ERROR"}function k(e){return e.kind=="TK_BOOLEAN"}function v(e){return e.kind=="TK_NUMBER"}function E(e){return e.kind=="TK_IDENTIFIER"}function m(e){return e.kind=="TK_LEFT"}function N(e){return e.kind=="TK_RIGHT"}function O(e){if(!_(e))return[{kind:"TK_ERROR",value:"invalid parentheses"}];let t=R(e).split(" ");return t=g(t),t.map(y)}function g(e){let n=[];for(let t of e)t!=""&&n.push(t);return n}function y(e){return h(e)??T(e)??D(e)??L(e)??{kind:"TK_ERROR",value:`invalid character ${e}`}}function h(e){if(e=="(")return{kind:"TK_LEFT"};if(e==")")return{kind:"TK_RIGHT"}}function T(e){return e==="True"?{kind:"TK_BOOLEAN",value:!0}:e==="False"?{kind:"TK_BOOLEAN",value:!1}:void 0}function D(e){let n=Number(e);if(!isNaN(n))return{kind:"TK_NUMBER",value:n}}function L(e){if(/^[_a-zA-Z][_a-zA-Z0-9]*$/.test(e))return{kind:"TK_IDENTIFIER",value:e};if(/^[.,:;!?<>\=\@\#\$\+\-\*\/\%\&\|\^\~]+$/.test(e))return{kind:"TK_IDENTIFIER",value:e}}function I(e){return e.kind=="ND_BOOLEAN"}function b(e){return e.kind=="ND_NUMBER"}function K(e){return e.kind=="ND_IDENTIFIER"}function A(e){return e.kind=="ND_CALL"}function B(e){let[n,t]=l(e,0);return t==e.length?[n,t]:t<e.length?[{kind:"ND_ERROR",value:"expected a single expression"},t]:[{kind:"ND_ERROR",value:"not all tokens could be evaluated"},t]}function l(e,n=0){if(n<e.length){let t=e[n];if(k(t))return n++,[{kind:"ND_BOOLEAN",value:t.value},n];if(v(t))return n++,[{kind:"ND_NUMBER",value:t.value},n];if(E(t))return n++,[{kind:"ND_IDENTIFIER",value:t.value},n];if(m(t)){n++;let u={kind:"ND_DEFAULT"},r=[];for([u,n]=l(e,n);n<e.length;){if(N(e[n]))return n++,[{kind:"ND_CALL",func:u,params:r},n];{let i={kind:"ND_DEFAULT"};[i,n]=l(e,n),r.push(i)}}return[{kind:"ND_ERROR",value:"expected closing parentheses"},n]}else return n++,[{kind:"ND_ERROR",value:`unable to parse token of kind ${e[n].kind}`},n]}else return[{kind:"ND_ERROR",value:"expected another token"},n]}function s(e){if(e.kind=="ND_ERROR")return e;if(e.kind=="ND_CALL"){const n=e;if(s(n.func)!==void 0)return e;for(let t of n.params)if(s(t)!==void 0)return t;return}else return}const c=new Map([["+",{kind:"function",arity:2,value:function(e,n){return e+n}}],["-",{kind:"function",arity:2,value:function(e,n){return e-n}}],["*",{kind:"function",arity:2,value:function(e,n){return e*n}}],["/",{kind:"function",arity:2,value:function(e,n){return e/n}}],["%",{kind:"function",arity:2,value:function(e,n){return e%n}}],["&",{kind:"function",arity:2,value:function(e,n){return e&&n}}],["|",{kind:"function",arity:2,value:function(e,n){return e||n}}],["!",{kind:"function",arity:1,value:function(e){return!e}}]]);function a(e,n){return n.get(e.value)}function f(e){if(I(e))return e.value;if(b(e))return e.value;if(K(e)){const n=e,t=a(n,c);return t!==void 0?t:`ERROR: unknown identifier '${n.value}'`}else if(A(e)){const n=e,t=a(n.func,c);if((t==null?void 0:t.kind)==="function")if(t.arity==n.params.length){const u=f(n.params[0]),r=f(n.params[1]);return t.value(u,r)}else return`ERROR: ${n.params.length} argument(s) provided, expected ${t.arity}. `;else return"ERROR: expected function identifier. "}return"ERROR: invalid expression. "}function F(e){const n=O(e),t=n.find(p);if(t!==void 0)return"ERROR: "+(t.value??"unknown");const[u,r]=B(n),i=s(u);if(i!==void 0)return"ERROR: "+(i.value??"unknown");const o=f(u);return o.kind==="EV_VALUE"?o.value:o.kind==="EV_ENTRY"?"ERROR: result is a function. ":o.kind==="EV_ERROR"?`ERROR: ${o.value}. `:"ERROR: unknown evaluation error. "}function $(){const e=document.getElementById("input"),n=document.getElementById("output"),t=e.value,u=F(t);n.textContent+=`> ${t}
${u}
`}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("output");e&&(e.textContent=`Welcome! Try typing:

(+ 1 2)

and press Enter. For more info run:

(help)

`);const n=document.getElementById("input");n==null||n.addEventListener("keydown",t=>{t.key==="Enter"&&(t.preventDefault(),$())})});
